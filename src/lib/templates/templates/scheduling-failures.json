{
  "id": "scheduling-failures-v1",
  "name": "Pod Scheduling Failure Analysis",
  "version": "1.0.0",
  "triageTarget": "scheduling-failures",
  "triggers": [ { "type": "static_target", "target": "scheduling-failures", "confidence": 1.0 } ],
  "blocks": [],
  "composition": { "infrastructure": [], "workload": [], "correlation": [] },
  "steps": [
    { "tool": "oc_read_describe", "params": { "resourceType": "pod", "namespace": "<ns>", "name": "<pendingPod>" }, "rationale": "Capture FailedScheduling events" },
    { "tool": "oc_read_describe", "params": { "resourceType": "ingresscontroller", "namespace": "openshift-ingress-operator", "name": "default" }, "rationale": "Controller placement/conditions" },
    { "tool": "oc_read_describe", "params": { "resourceType": "node", "name": "<nodeFromEvent>" }, "rationale": "Node taints/labels" },
    { "tool": "oc_read_machinesets", "params": { "sessionId": "<sessionId>", "namespace": "openshift-machine-api", "bounded": true }, "rationale": "Zone distribution across MachineSets" }
  ],
  "evidenceContract": {
    "version": "v1.0.0",
    "required": ["schedulingEvents", "controllerStatus", "nodeTaints", "nodeLabels", "machinesetZoneDistribution"],
    "selectors": {
      "schedulingEvents": [
        { "type": "eventsRegex", "path": "(?i)FailedScheduling" },
        { "type": "eventsRegex", "path": "0/\\d+\\s*nodes are available" },
        { "type": "eventsRegex", "path": "0/\\d+ nodes are available" }
      ],
      "controllerStatus": [
        { "type": "yq", "path": ".status.conditions[] | {type,status,reason,message}" },
        { "type": "eventsRegex", "path": "IngressController|DeploymentRollingOut" }
      ],
      "nodeTaints": [
        { "type": "jsonpath", "path": "{.spec.taints[*].key}" },
        { "type": "eventsRegex", "path": "(?i)taint|untolerated taint|had taint .* that the pod did not tolerate|did not tolerate|didn't tolerate" }
      ],
      "nodeLabels": [
        { "type": "eventsRegex", "path": "(?i)Labels" }
      ],
      "machinesetZoneDistribution": [
        { "type": "jsonpath", "path": "{.sets[*].zone}" },
        { "type": "eventsRegex", "path": "(?i)zone|topology|spread.*violation|us-[a-z]+-\\d[a-z]" }
      ]
    },
    "completenessThreshold": 0.9
  },
  "boundaries": { "maxSteps": 3, "timeoutMs": 20000 }
}
