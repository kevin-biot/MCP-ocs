{
  "id": "pvc-binding-v1",
  "name": "PVC Binding Analysis",
  "version": "1.0.0",
  "triageTarget": "pvc-binding",
  "triggers": [ { "type": "static_target", "target": "pvc-binding", "confidence": 1.0 } ],
  "blocks": [],
  "composition": { "infrastructure": [], "workload": [] },
  "steps": [
    { "tool": "oc_read_describe", "params": { "resourceType": "pvc", "namespace": "<ns>", "name": "<pvc>" }, "rationale": "PVC spec and events" },
    { "tool": "oc_read_describe", "params": { "resourceType": "storageclass", "name": "<sc|default>" }, "rationale": "Storage class capabilities" },
    { "tool": "oc_read_describe", "params": { "resourceType": "resourcequota", "namespace": "<ns>" }, "rationale": "Quota limits" }
  ],
  "evidenceContract": {
    "version": "v1.0.0",
    "required": ["pvcSpec", "scInfo", "quota", "bindingMode", "allowedTopologies", "topologyMismatch"],
    "selectors": {
      "pvcSpec": [
        { "type": "yq", "path": ".spec" },
        { "type": "eventsRegex", "path": "PersistentVolumeClaim|Status:\\s*Pending|no \\\n+(matching \\\n+\\s*)?PersistentVolume|no PersistentVolume|no matching PersistentVolume|waiting for a volume to be created/bound" }
      ],
      "scInfo": [ { "type": "yq", "path": ".parameters" }, { "type": "eventsRegex", "path": "StorageClass" } ],
      "quota": [ { "type": "yq", "path": ".status.hard" }, { "type": "eventsRegex", "path": "Resource Quotas|hard|exceeded quota|exceeds|quota exceeded|exceeds usage" } ],
      "bindingMode": [ { "type": "eventsRegex", "path": "WaitForFirstConsumer|Immediate" } ],
      "allowedTopologies": [ { "type": "eventsRegex", "path": "allowedTopologies|topology.kubernetes.io/zone" } ],
      "topologyMismatch": [ { "type": "eventsRegex", "path": "no matching topology|no PV found in zone|0/\\d+ nodes are available" } ]
    },
    "completenessThreshold": 0.8
  },
  "boundaries": { "maxSteps": 3, "timeoutMs": 20000 }
}
